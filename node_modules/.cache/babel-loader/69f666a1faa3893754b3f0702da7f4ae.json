{"ast":null,"code":"var _jsxFileName = \"/Users/aluan/Documents/GitHub/GeoPunk/src/CustomStyle.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef } from 'react';\nimport Sketch from 'react-p5';\nimport MersenneTwister from 'mersenne-twister';\nimport Mappa from \"mappa.js\";\nimport 'p5.easycam.js'; //-------------------------------------------\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet DEFAULT_SIZE = 500; //-------------------------------------------\n\nlet frameCountPerCicle = 200;\nlet CFrameCount, CQuartEaseInR, CQuartEaseOutR;\nlet CProgressR, CQuadEaseInR, CQuadEaseOutR;\nlet back,\n    back2,\n    dis = 120,\n    mapId,\n    landId;\nlet inconsolata, mapDefult;\nlet displace, mosaic, sobel;\nlet land = [],\n    landImg = [];\nlet jsonFile, img, pg, img2, objs, radHash;\nlet checkDot = [2000],\n    checkCount = 0,\n    title,\n    subtitle;\nlet fontPosY, fontsize, readid, fontPosY2, fontsize2;\nlet timeLine = 0,\n    tempHash; //-------------------------------------------\n\nconst CustomStyle = ({\n  block,\n  canvasRef,\n  attributesRef,\n  width,\n  height,\n  handleResize,\n  mod1 = 0.75,\n  // Example: replace any number in the code with mod1, mod2, or color values\n  mod2 = 0.25,\n  color1 = 'hsl(170,90%,10%)',\n  background = 'hsl(110,80%,10%)'\n}) => {\n  _s();\n\n  const shuffleBag = useRef();\n  const hoistedValue = useRef();\n  const {\n    hash\n  } = block; //-------------------------------------------\n\n  const setup = (p5, canvasParentRef) => {\n    // Keep reference of canvas element for snapshots\n    let _p5 = p5.createCanvas(width, height, p5.WEBGL).parent(canvasParentRef);\n\n    canvasRef.current = p5; //-------------------------------------------loading\n\n    inconsolata = p5.loadFont('HindGuntur-Light.ttf');\n    displace = p5.loadShader('shader/displace.vert', 'shader/displace.frag');\n    mosaic = p5.loadShader('shader/mosaic.vert', 'shader/mosaic.frag');\n    sobel = p5.loadShader('shader/sobel.vert', 'shader/sobel.frag');\n    land[0] = p5.loadModel('model/cone3.obj');\n    land[1] = p5.loadModel('model/cube3.obj');\n    land[2] = p5.loadModel('model/cross2.obj');\n    land[3] = p5.loadModel('model/quad.obj');\n    landImg[0] = p5.loadImage(\"model/cone3.png\");\n    landImg[1] = p5.loadImage(\"model/cube3.png\");\n    landImg[2] = p5.loadImage(\"model/cross3.png\");\n    landImg[3] = p5.loadImage(\"model/quad4.png\");\n    mapDefult = p5.loadImage(\"model/map.png\");\n    jsonFile = p5.loadJSON(\"GeoPunk.json\");\n    pg = p5.createGraphics(640, 640); //-------------------------------------------setting\n\n    p5.easycam = p5.createEasyCam({\n      distance: dis,\n      center: [0, 5, 0]\n    });\n    p5.easycam.setDistanceMin(60);\n    p5.easycam.setDistanceMax(300);\n    p5.textSize(0.10);\n    p5.textAlign(p5.LEFT, p5.CENTER);\n    p5.textFont(inconsolata); //-------------------------------------------\n\n    attributesRef.current = () => {\n      return {\n        attributes: [{\n          display_type: 'number',\n          trait_type: 'your trait here number',\n          value: hoistedValue.current\n        }, {\n          trait_type: 'your trait here text',\n          value: 'replace me'\n        }]\n      };\n    };\n  };\n\n  const draw = p5 => {\n    let WIDTH = width;\n    let HEIGHT = height;\n    let DIM = Math.min(WIDTH, HEIGHT);\n    let M = DIM / DEFAULT_SIZE; // console.log(block);\n\n    if (p5.frameCount == 10) {\n      tempHash = block;\n    } else {\n      timeLine = timeLine + 1;\n\n      if (tempHash != block) {\n        tempHash = block;\n        timeLine = 0;\n      }\n\n      console.log(timeLine);\n    } //-------------------------------------------mainShape\n\n\n    p5.background(background);\n    p5.blendMode(p5.BLEND);\n    p5.noStroke();\n    p5.textSize(0.10);\n    p5.perspective(60 * p5.PI / 180, width / height, 0.1, 5000);\n    back = p5.abs(p5.millis() % 6000 / 6000 - 0.5) - 0.5;\n    back2 = p5.millis() / 3000;\n    p5.rotateZ(back);\n    p5.rotateX(back);\n    p5.rotateY(back2); //------------------------------------------- reset shuffle bag\n\n    {\n      if (timeLine < 30) {// p5.normalMaterial();\n        // p5.sphere(10,30,30);\n      } else if (timeLine == 30) {\n        //loading .png file\n        let seed = parseInt(hash.slice(0, 16), 16);\n        shuffleBag.current = new MersenneTwister(seed);\n        mapId = parseInt(shuffleBag.current.random() * 4);\n        landId = parseInt(shuffleBag.current.random() * 160);\n        console.log(jsonFile[landId]);\n        img = p5.loadImage(\"slitMap/\" + landId + \".png\");\n        img2 = p5.loadImage(\"sobel/p_\" + landId + \".png\");\n        hoistedValue.current = 42;\n        objs = block.transactions.map(t => {\n          let seed = parseInt(t.hash.slice(0, 16), 16);\n          let invert = shuffleBag.current.random(); // console.log(invert);\n\n          let dir = 1;\n          if (invert > 0.5) dir = 1;else dir = -1;\n          return {\n            name: t.hash,\n            z: (shuffleBag.current.random() * 2 + 1) * dir,\n            radius: seed / 500000000000000000\n          };\n        });\n      } else if (timeLine > 30) {\n        pg.background(0);\n        if (img != null) pg.image(img, 0, 0, 640, 640);\n        pg.image(landImg[mapId], 0, 0, 640, 640);\n        p5.shader(displace);\n        displace.setUniform(\"colormap\", pg);\n        displace.setUniform(\"mapId\", mapId);\n        displace.setUniform(\"mod1\", mod1);\n        displace.setUniform(\"mod2\", 2.0 * (mod2 - 0.5));\n        displace.setUniform(\"color1\", [p5.red(color1) / 510, p5.green(color1) / 510, p5.blue(color1) / 510]);\n        {\n          // post-effect-invert\n          let checkInvert = p5.frameCount % 600;\n          let checkNum;\n          if (checkInvert < 100) checkNum = Math.random();\n          if (checkNum > 0.8) displace.setUniform(\"n\", 0);else displace.setUniform(\"n\", 1);\n          displace.setUniform(\"uFrameCount\", p5.frameCount);\n        }\n        p5.scale(12);\n        p5.stroke(255);\n        p5.strokeWeight(2);\n\n        for (let i = 0; i < 100; i++) {\n          let e = p5.lerp(3, -3, i / 100);\n          p5.point(0, e, 0);\n        }\n\n        p5.noStroke();\n        p5.fill(255);\n        p5.model(land[mapId]);\n        p5.resetShader(); //-------------------------------------------draw box\n\n        {\n          p5.push();\n          p5.noFill();\n          p5.stroke(100, 10);\n\n          if (mapId == 0) {\n            p5.translate(0, 0.5, 0);\n            p5.scale(0.8, 0.2, 0.8);\n          } else if (mapId == 1) {\n            p5.translate(0, 0.1, 0);\n            p5.scale(0.9, 0.25, 0.9);\n          } else if (mapId == 2) {\n            p5.scale(1, 0.2, 1);\n          } else if (mapId == 3) {\n            p5.translate(0, 0.4, 0);\n            p5.scale(1, 0.2, 1);\n          }\n\n          p5.box(8);\n          p5.pop();\n        } //-------------------------------------------draw transaction\n\n        {\n          p5.noFill();\n\n          for (let i = 0; i < objs.length; i++) {\n            p5.push();\n            p5.translate(0, objs[i].z, 0);\n            p5.rotateX(3.14 / 2);\n\n            if (i == radHash) {\n              p5.stroke(255, 0, 0, 150);\n              p5.strokeWeight(2.0);\n              p5.scale(2.0);\n            } else {\n              p5.stroke(250, 100);\n              p5.strokeWeight(0.5);\n              p5.scale(1.0);\n            }\n\n            p5.ellipse(0, 0, objs[i].radius, objs[i].radius, 20);\n            p5.pop();\n          }\n        } //-------------------------------------------otherLine\n\n        {\n          p5.resetShader();\n          p5.push();\n          p5.fill(255);\n          p5.translate(0, 3, 0);\n          p5.sphere(0.05, 20, 20);\n          p5.translate(0, -6, 0);\n          p5.sphere(0.05, 20, 20);\n          p5.pop(); //-------\n\n          p5.resetShader();\n          p5.push();\n          p5.fill(255);\n          p5.rotateY(p5.millis() / 2300);\n          p5.translate(2, -2, 0);\n          p5.shader(mosaic);\n          mosaic.setUniform(\"colormap\", img);\n          mosaic.setUniform(\"color1\", [p5.red(color1) / 510, p5.green(color1) / 510, p5.blue(color1) / 510]);\n          p5.stroke(255);\n          p5.strokeWeight(0.2);\n          p5.rect(0, 0, 1, 0.7);\n          p5.strokeWeight(2);\n\n          for (let i = 0; i < 20; i++) {\n            let e = p5.lerp(0.35, 1.6, i / 20);\n            p5.point(-0.6, e, 0);\n          }\n\n          for (let i = 0; i < 5; i++) {\n            let e = p5.lerp(-0.2, -0.6, i / 5);\n            p5.point(e, 0.35, 0);\n          } //-------\n\n\n          p5.resetShader();\n          p5.noFill();\n          p5.stroke(255);\n          p5.strokeWeight(2);\n          p5.rect(0, 0, 1, 0.70);\n          p5.strokeWeight(4);\n          p5.point(-0.6, 1.6, 0);\n          p5.point(-0.2, 0.35, 0);\n          p5.pop(); //-------\n\n          p5.push();\n          p5.fill(255);\n          p5.rotateY(p5.millis() / 1100);\n          p5.translate(2.5, -2.5, 0);\n          p5.stroke(255);\n          p5.strokeWeight(0.2);\n          p5.strokeWeight(2);\n\n          for (let i = 0; i < 20; i++) {\n            let e = p5.lerp(0.35, 2.2, i / 20);\n            p5.point(-0.6, e, 0);\n          }\n\n          for (let i = 0; i < 5; i++) {\n            let e = p5.lerp(-0.3, -0.6, i / 5);\n            p5.point(e, 0.35, 0);\n          } //-------\n\n\n          p5.strokeWeight(4);\n          p5.point(-0.6, 2.2, 0);\n          p5.point(-0.3, 0.35, 0);\n          p5.fill(255);\n          p5.text('LAT:' + jsonFile[landId].lat, -0.2, 0.2);\n          p5.text('LNG:' + jsonFile[landId].lng, -0.2, 0.4);\n          p5.pop();\n        } //-------------------------------------------drawHud\n\n        {\n          let cameraZoom = p5.easycam.getDistance();\n          let gridDist = p5.int(p5.map(cameraZoom, 60, 300, 15, 6)); //-------------------------------------------\n\n          p5.easycam.beginHUD();\n          p5.push();\n          {\n            p5.resetShader();\n            p5.blendMode(p5.SCREEN);\n            sobel.setUniform(\"resolution\", [640.0, 640.0]);\n            sobel.setUniform(\"colormap\", img2);\n            if (p5.frameCount % 10 == 0) sobel.setUniform(\"pos\", [Math.random() * 2.0 - 1.0, Math.random() * 2.0 - 1.0]); // sobel.setUniform(\"vol\",vol );\n\n            sobel.setUniform(\"time\", p5.float(p5.frameCount % 100000) / 1000.0);\n            p5.shader(sobel);\n            p5.fill(100, 100);\n            p5.rect(0, 0, width, height); // p5.image(img2,0,0,width,height);\n          }\n          p5.pop(); //-----------------\n\n          p5.resetShader();\n          {\n            p5.fill(100, 100); // text(place[radPlace].name,20,60);\n\n            p5.strokeWeight(1.0);\n\n            for (var i = 0; i < width; i += gridDist * 10) {\n              p5.stroke(80, 50);\n              p5.line(i, 0, i, height);\n              p5.line(width, i, 0, i);\n            }\n\n            checkCount = 0;\n\n            if (timeLine % 30 === 0) {\n              for (let i = 0; i < width; i += gridDist * 10) {\n                for (let j = 0; j < height; j += gridDist * 10) {\n                  let k = p5.random(10);\n                  if (k > 5) checkDot[checkCount] = false;else checkDot[checkCount] = true;\n                  if (checkDot[checkCount]) p5.point(i, j);\n                  checkCount++;\n                }\n              }\n            }\n\n            checkCount = 0;\n            p5.strokeWeight(3.0);\n            p5.stroke(150, 100);\n\n            for (let i = 0; i < width; i += gridDist * 10) {\n              for (let j = 0; j < height; j += gridDist * 10) {\n                if (checkDot[checkCount]) p5.point(i, j);\n                checkCount++;\n              }\n            }\n          } //-----------------\n\n          if (timeLine % 20 === 0) {\n            fontPosY = p5.random(-100, 100) + height / 2;\n            fontsize = p5.random(20, 40);\n            readid = p5.int(p5.random(4));\n            if (readid == 0) title = jsonFile[landId].longnameA;else if (readid == 1) title = jsonFile[landId].longnameB;else if (readid == 2) title = jsonFile[landId].longnameC;else title = jsonFile[landId].longnameD;\n          }\n\n          if (timeLine % 5 === 0) {\n            fontPosY2 = p5.random(-100, 100) + height / 2;\n            fontsize2 = p5.random(10, 20);\n          }\n\n          p5.blendMode(p5.BLEND);\n          p5.fill(250, p5.random(150, 200));\n          p5.textSize(fontsize);\n          if (title != null) p5.text(title, 10, fontPosY); //\n\n          p5.textSize(fontsize2);\n          p5.fill(200, 60);\n          p5.text(jsonFile[landId].formatted_address, 10, fontPosY2); //   //-----------------\n\n          p5.textAlign(p5.CENTER, p5.CENTER);\n          p5.textSize(14);\n          p5.fill(150, 60); //\n\n          if (objs == null) p5.text(hash, width / 2, height - height * 0.05);else {\n            if (timeLine % 30 == 0) radHash = p5.int(p5.random(objs.length));\n\n            if (objs[radHash] != null) {\n              // console.log(objs[radHash]);\n              p5.text(objs[radHash].name, width / 2, height - height * 0.05);\n            }\n          } //\n          // drawFrame(p5,width,height);\n\n          p5.easycam.endHUD();\n        } //-------------------------------------------\n      }\n    } //-------------------------------------------\n  };\n\n  return /*#__PURE__*/_jsxDEV(Sketch, {\n    setup: setup,\n    draw: draw,\n    windowResized: handleResize\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 380,\n    columnNumber: 10\n  }, this);\n};\n\n_s(CustomStyle, \"eAcgvS7ZIhq58SkvxAYMJjr24hY=\");\n\n_c = CustomStyle;\nexport default CustomStyle;\nconst styleMetadata = {\n  name: '',\n  description: '',\n  image: '',\n  creator_name: '',\n  options: {\n    mod1: 0.15,\n    mod2: 0.7,\n    color1: \"hsl(\" + parseInt(Math.random() * 360) + \",90%,10%)\",\n    background: \"hsl(\" + parseInt(Math.random() * 360) + \",80%,10%)\"\n  }\n};\nexport { styleMetadata };\n\nvar _c;\n\n$RefreshReg$(_c, \"CustomStyle\");","map":{"version":3,"sources":["/Users/aluan/Documents/GitHub/GeoPunk/src/CustomStyle.js"],"names":["React","useRef","Sketch","MersenneTwister","Mappa","DEFAULT_SIZE","frameCountPerCicle","CFrameCount","CQuartEaseInR","CQuartEaseOutR","CProgressR","CQuadEaseInR","CQuadEaseOutR","back","back2","dis","mapId","landId","inconsolata","mapDefult","displace","mosaic","sobel","land","landImg","jsonFile","img","pg","img2","objs","radHash","checkDot","checkCount","title","subtitle","fontPosY","fontsize","readid","fontPosY2","fontsize2","timeLine","tempHash","CustomStyle","block","canvasRef","attributesRef","width","height","handleResize","mod1","mod2","color1","background","shuffleBag","hoistedValue","hash","setup","p5","canvasParentRef","_p5","createCanvas","WEBGL","parent","current","loadFont","loadShader","loadModel","loadImage","loadJSON","createGraphics","easycam","createEasyCam","distance","center","setDistanceMin","setDistanceMax","textSize","textAlign","LEFT","CENTER","textFont","attributes","display_type","trait_type","value","draw","WIDTH","HEIGHT","DIM","Math","min","M","frameCount","console","log","blendMode","BLEND","noStroke","perspective","PI","abs","millis","rotateZ","rotateX","rotateY","seed","parseInt","slice","random","transactions","map","t","invert","dir","name","z","radius","image","shader","setUniform","red","green","blue","checkInvert","checkNum","scale","stroke","strokeWeight","i","e","lerp","point","fill","model","resetShader","push","noFill","translate","box","pop","length","ellipse","sphere","rect","text","lat","lng","cameraZoom","getDistance","gridDist","int","beginHUD","SCREEN","float","line","j","k","longnameA","longnameB","longnameC","longnameD","formatted_address","endHUD","styleMetadata","description","creator_name","options"],"mappings":"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","sourcesContent":["import React, { useRef } from 'react';\nimport Sketch from 'react-p5';\nimport MersenneTwister from 'mersenne-twister';\nimport Mappa from \"mappa.js\";\nimport 'p5.easycam.js';\n//-------------------------------------------\nlet DEFAULT_SIZE = 500;\n//-------------------------------------------\nlet frameCountPerCicle = 200;\nlet CFrameCount,CQuartEaseInR,CQuartEaseOutR;\nlet CProgressR,CQuadEaseInR,CQuadEaseOutR;\nlet back,back2,dis=120,mapId,landId;\nlet inconsolata,mapDefult;\nlet displace,mosaic,sobel;\nlet land=[],landImg=[];\nlet jsonFile,img,pg,img2,objs,radHash;\nlet checkDot=[2000],checkCount=0,title,subtitle;\nlet fontPosY,fontsize,readid,fontPosY2,fontsize2;\nlet timeLine=0,tempHash;\n//-------------------------------------------\nconst CustomStyle = ({\n  block,\n  canvasRef,\n  attributesRef,\n  width,\n  height,\n  handleResize,\n  mod1 = 0.75, // Example: replace any number in the code with mod1, mod2, or color values\n  mod2 = 0.25,\n  color1 = 'hsl(170,90%,10%)',\n  background = 'hsl(110,80%,10%)',\n}) => {\n  const shuffleBag = useRef();\n  const hoistedValue = useRef();\n  const { hash } = block;\n  //-------------------------------------------\n  const setup = (p5, canvasParentRef) => {\n    // Keep reference of canvas element for snapshots\n    let _p5 = p5.createCanvas(width, height,p5.WEBGL).parent(canvasParentRef);\n    canvasRef.current = p5;\n    //-------------------------------------------loading\n    inconsolata = p5.loadFont('HindGuntur-Light.ttf');\n    displace = p5.loadShader('shader/displace.vert', 'shader/displace.frag');\n    mosaic = p5.loadShader('shader/mosaic.vert', 'shader/mosaic.frag');\n    sobel=p5.loadShader('shader/sobel.vert', 'shader/sobel.frag');\n    land[0]=p5.loadModel('model/cone3.obj');\n    land[1]=p5.loadModel('model/cube3.obj');\n    land[2]=p5.loadModel('model/cross2.obj');\n    land[3]=p5.loadModel('model/quad.obj');\n    landImg[0]=p5.loadImage(\"model/cone3.png\");\n    landImg[1]=p5.loadImage(\"model/cube3.png\");\n    landImg[2]=p5.loadImage(\"model/cross3.png\");\n    landImg[3]=p5.loadImage(\"model/quad4.png\");\n    mapDefult=p5.loadImage(\"model/map.png\");\n    jsonFile=p5.loadJSON(\"GeoPunk.json\");\n    pg = p5.createGraphics(640, 640);\n    //-------------------------------------------setting\n    p5.easycam = p5.createEasyCam({distance:dis,center: [0,5,0] });\n    p5.easycam.setDistanceMin(60);\n    p5.easycam.setDistanceMax(300);\n    p5.textSize(0.10);\n    p5.textAlign(p5.LEFT, p5.CENTER);\n    p5.textFont(inconsolata);\n    //-------------------------------------------\n    attributesRef.current = () => {\n      return {\n        attributes: [\n          {\n            display_type: 'number',\n            trait_type: 'your trait here number',\n            value: hoistedValue.current,\n          },\n          {\n            trait_type: 'your trait here text',\n            value: 'replace me',\n          },\n        ],\n      };\n    };\n  };\n\n  const draw = (p5) => {\n    let WIDTH = width;\n    let HEIGHT = height;\n    let DIM = Math.min(WIDTH, HEIGHT);\n    let M = DIM / DEFAULT_SIZE;\n    // console.log(block);\n    if (p5.frameCount == 10) {\n      tempHash = block;\n    } else {\n      timeLine=timeLine+1;\n      if(tempHash!=block){\n        tempHash = block;\n        timeLine=0;\n      }\n      console.log(timeLine);\n    }\n    //-------------------------------------------mainShape\n    p5.background(background);\n    p5.blendMode(p5.BLEND);\n    p5.noStroke();\n    p5.textSize(0.10);\n    p5.perspective(60 * p5.PI/180, width/height, 0.1, 5000);\n    back=p5.abs(((p5.millis()%6000) / 6000)-0.5)-0.5;\n    back2=p5.millis() / 3000;\n    p5.rotateZ(back);\n    p5.rotateX(back);\n    p5.rotateY(back2);\n    //------------------------------------------- reset shuffle bag\n    {\n      if(timeLine<30){\n        // p5.normalMaterial();\n        // p5.sphere(10,30,30);\n      } else if(timeLine==30){//loading .png file\n        let seed = parseInt(hash.slice(0, 16), 16);\n        shuffleBag.current = new MersenneTwister(seed);\n        mapId   = parseInt(shuffleBag.current.random()*4);\n        landId  = parseInt(shuffleBag.current.random()*160);\n        console.log(jsonFile[landId]);\n        img =p5.loadImage(\"slitMap/\"+landId+\".png\");\n        img2=p5.loadImage(\"sobel/p_\"+landId+\".png\");\n        hoistedValue.current = 42;\n        objs = block.transactions.map((t) => {\n          let seed = parseInt(t.hash.slice(0, 16), 16);\n          let invert=shuffleBag.current.random();\n          // console.log(invert);\n          let dir=1;\n          if(invert>0.5)dir=1;\n          else dir=-1;\n          return {\n            name:t.hash,\n            z: (shuffleBag.current.random()*2+1)*dir,\n            radius: seed / 500000000000000000,\n          };\n        });\n      }else if(timeLine>30){\n        pg.background(0);\n        if(img != null)pg.image(img,0,0,640,640);\n        pg.image(landImg[mapId],0,0,640,640);\n        p5.shader(displace);\n        displace.setUniform(\"colormap\", pg);\n        displace.setUniform(\"mapId\", mapId);\n        displace.setUniform(\"mod1\", mod1);\n        displace.setUniform(\"mod2\", 2.0*(mod2-0.5));\n        displace.setUniform(\"color1\", [p5.red(color1)/510,p5.green(color1)/510,p5.blue(color1)/510]);\n        { // post-effect-invert\n          let checkInvert=(p5.frameCount%600);\n          let checkNum;\n          if(checkInvert<100)checkNum=Math.random();\n          if(checkNum>0.8)displace.setUniform(\"n\", 0);\n          else displace.setUniform(\"n\", 1);\n          displace.setUniform(\"uFrameCount\", p5.frameCount);\n        }\n        p5.scale(12);\n        p5.stroke(255);\n        p5.strokeWeight(2);\n        for(let i=0;i<100;i++){\n          let e = p5.lerp(3, -3, i/100);\n          p5.point(0,e,0);\n        }\n        p5.noStroke();\n        p5.fill(255);\n        p5.model(land[mapId]);\n        p5.resetShader();\n        //-------------------------------------------draw box\n        {\n          p5.push();\n          p5.noFill();\n          p5.stroke(100,10);\n          if(mapId==0){\n            p5.translate(0,0.5,0);\n            p5.scale(0.8,0.2,0.8);\n          }\n          else if(mapId==1){\n            p5.translate(0,0.1,0);\n            p5.scale(0.9,0.25,0.9);\n          }\n          else if(mapId==2){\n            p5.scale(1,0.2,1);\n          }\n          else if(mapId==3){\n            p5.translate(0,0.4,0);\n            p5.scale(1,0.2,1);\n          }\n          p5.box(8);\n          p5.pop();\n        }\n        //-------------------------------------------draw transaction\n        {\n          p5.noFill();\n          for(let i=0;i<objs.length;i++){\n            p5.push();\n            p5.translate(0,objs[i].z,0);\n            p5.rotateX(3.14/2);\n            if(i==radHash){\n              p5.stroke(255,0,0,150);\n              p5.strokeWeight(2.0);\n              p5.scale(2.0);\n            }else{\n              p5.stroke(250,100);\n              p5.strokeWeight(0.5);\n              p5.scale(1.0);\n            }\n            p5.ellipse(0,0,objs[i].radius,objs[i].radius,20);\n            p5.pop();\n          }\n        }\n        //-------------------------------------------otherLine\n        {\n          p5.resetShader();\n          p5.push();\n          p5.fill(255);\n          p5.translate(0,3,0);\n          p5.sphere(0.05,20,20);\n          p5.translate(0,-6,0);\n          p5.sphere(0.05,20,20);\n          p5.pop();\n          //-------\n          p5.resetShader();\n          p5.push();\n          p5.fill(255);\n          p5.rotateY(p5.millis() / 2300);\n          p5.translate(2,-2,0);\n          p5.shader(mosaic);\n          mosaic.setUniform(\"colormap\", img);\n          mosaic.setUniform(\"color1\", [p5.red(color1)/510,p5.green(color1)/510,p5.blue(color1)/510]);\n          p5.stroke(255);\n          p5.strokeWeight(0.2);\n          p5.rect(0,0,1,0.7);\n          p5.strokeWeight(2);\n          for(let i=0;i<20;i++){\n            let e = p5.lerp(0.35, 1.6, i/20);\n            p5.point(-0.6,e,0);\n          }\n          for(let i=0;i<5;i++){\n            let e = p5.lerp(-0.2, -0.6, i/5);\n            p5.point(e,0.35,0);\n          }\n          //-------\n          p5.resetShader();\n          p5.noFill();\n          p5.stroke(255);\n          p5.strokeWeight(2);\n          p5.rect(0,0,1,0.70);\n          p5.strokeWeight(4);\n          p5.point(-0.6,1.6,0);\n          p5.point(-0.2,0.35,0);\n          p5.pop();\n          //-------\n          p5.push();\n          p5.fill(255);\n          p5.rotateY(p5.millis() / 1100);\n          p5.translate(2.5,-2.5,0);\n          p5.stroke(255);\n          p5.strokeWeight(0.2);\n          p5.strokeWeight(2);\n          for(let i=0;i<20;i++){\n            let e = p5.lerp(0.35, 2.2, i/20);\n            p5.point(-0.6,e,0);\n          }\n          for(let i=0;i<5;i++){\n            let e = p5.lerp(-0.3, -0.6, i/5);\n            p5.point(e,0.35,0);\n          }\n          //-------\n          p5.strokeWeight(4);\n          p5.point(-0.6,2.2,0);\n          p5.point(-0.3,0.35,0);\n          p5.fill(255);\n          p5.text('LAT:'+jsonFile[landId].lat, -0.2, 0.2);\n          p5.text('LNG:'+jsonFile[landId].lng, -0.2, 0.4);\n          p5.pop();\n        }\n        //-------------------------------------------drawHud\n        {\n          let cameraZoom=p5.easycam.getDistance();\n          let gridDist=p5.int(p5.map(cameraZoom,60,300,15,6));\n          //-------------------------------------------\n          p5.easycam.beginHUD();\n          p5.push();\n          {\n            p5.resetShader();\n            p5.blendMode(p5.SCREEN);\n            sobel.setUniform(\"resolution\", [640.0,640.0]);\n            sobel.setUniform(\"colormap\", img2);\n            if(p5.frameCount%10==0)sobel.setUniform(\"pos\", [Math.random()*2.0-1.0,Math.random()*2.0-1.0]);\n            // sobel.setUniform(\"vol\",vol );\n            sobel.setUniform(\"time\", p5.float(p5.frameCount%100000)/1000.0);\n            p5.shader(sobel);\n            p5.fill(100,100);\n            p5.rect(0,0,width,height);\n            // p5.image(img2,0,0,width,height);\n\n          }\n          p5.pop();\n          //-----------------\n          p5.resetShader();\n          {\n            p5.fill(100,100)\n            // text(place[radPlace].name,20,60);\n            p5.strokeWeight(1.0);\n            for (var i = 0; i < width; i += gridDist*10) {\n              p5.stroke(80,50);\n              p5.line(i, 0, i, height);\n              p5.line(width, i, 0, i);\n            }\n            checkCount=0;\n            if(timeLine%30===0){\n              for (let i = 0; i < width; i += gridDist*10) {\n                for (let j = 0; j < height; j += gridDist*10) {\n                  let k=p5.random(10);\n                  if(k>5)checkDot[checkCount]=false;\n                  else checkDot[checkCount]=true;\n                  if(checkDot[checkCount])p5.point(i,j);\n                  checkCount++;\n                }\n              }\n            }\n            checkCount=0;\n            p5.strokeWeight(3.0);\n            p5.stroke(150,100)\n            for (let i = 0; i < width; i += gridDist*10) {\n              for (let j = 0; j < height; j += gridDist*10) {\n                if(checkDot[checkCount])p5.point(i,j);\n                checkCount++;\n              }\n            }\n          }\n          //-----------------\n            if (timeLine%20===0) {\n              fontPosY=p5.random(-100,100)+height/2;\n              fontsize=p5.random(20, 40);\n              readid=p5.int(p5.random(4));\n              if(readid==0)title=jsonFile[landId].longnameA;\n              else if(readid==1)title=jsonFile[landId].longnameB;\n              else if(readid==2)title=jsonFile[landId].longnameC;\n              else title=jsonFile[landId].longnameD;\n            }\n\n            if (timeLine%5===0) {\n              fontPosY2=p5.random(-100,100)+height/2;\n              fontsize2=p5.random(10, 20);\n            }\n            p5.blendMode(p5.BLEND);\n            p5.fill(250,p5.random(150,200));\n            p5.textSize(fontsize);\n\n            if(title!=null)p5.text(title, 10, fontPosY);\n          //\n            p5.textSize(fontsize2);\n            p5.fill(200,60);\n            p5.text(jsonFile[landId].formatted_address, 10, fontPosY2);\n          //   //-----------------\n            p5.textAlign(p5.CENTER,p5.CENTER);\n            p5.textSize(14);\n            p5.fill(150,60);\n          //\n\n\n          if(objs==null)p5.text(hash, width/2,height-height*0.05);\n          else {\n            if(timeLine%30==0)radHash=p5.int(p5.random(objs.length));\n            if(objs[radHash]!=null){\n              // console.log(objs[radHash]);\n              p5.text(objs[radHash].name, width/2,height-height*0.05);\n            }\n          }\n\n\n          //\n          // drawFrame(p5,width,height);\n          p5.easycam.endHUD();\n        }\n        //-------------------------------------------\n      }\n    }\n    //-------------------------------------------\n  };\n\n  return <Sketch setup={setup} draw={draw} windowResized={handleResize} />;\n};\n\nexport default CustomStyle;\n\nconst styleMetadata = {\n  name: '',\n  description: '',\n  image: '',\n  creator_name: '',\n  options: {\n    mod1: 0.15,\n    mod2: 0.7,\n    color1 : \"hsl(\"+parseInt(Math.random()*360)+\",90%,10%)\",\n    background :\"hsl(\"+parseInt(Math.random()*360)+\",80%,10%)\"\n  },\n};\nexport { styleMetadata };\n"]},"metadata":{},"sourceType":"module"}